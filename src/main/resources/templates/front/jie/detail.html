<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>Fly Template v3.0，基于 layui 的极简社区页面模版</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="fly,layui,前端社区">
    <meta name="description" content="Fly社区是模块化前端UI框架Layui的官网社区，致力于为web开发提供强劲动力">
    <link rel="stylesheet" th:href="@{/front/res/layui/css/layui.css}" href="../res/layui/css/layui.css">
    <link rel="stylesheet" th:href="@{/admin/assets/module/admin.css(v=318)}" href="admin/module/admin.css?v=318"/>
    <link rel="stylesheet" th:href="@{/front/res/css/global.css}" href="../res/css/global.css">
    <style type="text/css">
        .detail-about-reply {
            padding-right: 20px !important;
        }

        .tox-fullscreen {
            z-index: 99999 !important;
        }

        .captcha {
          height: 38px;
          width: 100px;
          cursor: pointer;
          box-sizing: border-box;
          border: 1px solid #e6e6e6;
          border-radius: 2px !important;
        }

        h1.title span.layui-badge-green {
            top: -2px;
            height: 24px;
            line-height: 24px;
            padding: 0 6px;
            font-size: 14px;
            color: #52c41a;
            background: #f6ffed;
            border: 1px solid #b7eb8f;
        }

        .post-footer {
          text-align: center;
          margin-top: 16px;
        }

        .layui-icon {
          font-size: 24px;
          margin-right: 16px;
          cursor: pointer;
        }

        .layui-icon i {
          font-size: 18px;
          padding: 4px;
        }
    </style>
</head>
<body>

<div class="fly-header layui-bg-black">
    <div class="layui-container">
        <a class="fly-logo" href="/">
            <img th:src="@{/front/res/images/logo.png}" src="../../res/images/logo.png" alt="layui">
        </a>
        <ul class="layui-nav fly-nav layui-hide-xs">
            <li class="layui-nav-item layui-this">
                <a href="/"><i class="iconfont icon-jiaoliu"></i>交流</a>
            </li>
            <li class="layui-nav-item">
                <a href="../case/case.html"><i class="iconfont icon-iconmingxinganli"></i>案例</a>
            </li>
            <li class="layui-nav-item">
                <a href="http://www.layui.com/" target="_blank"><i class="iconfont icon-ui"></i>框架</a>
            </li>
        </ul>

        <ul class="layui-nav fly-nav-user">

            <!-- 未登入的状态 -->
            <!--
            <li class="layui-nav-item">
              <a class="iconfont icon-touxiang layui-hide-xs" href="user/login.html"></a>
            </li>
            <li class="layui-nav-item">
              <a href="user/login.html">登入</a>
            </li>
            <li class="layui-nav-item">
              <a href="user/reg.html">注册</a>
            </li>
            <li class="layui-nav-item layui-hide-xs">
              <a href="/app/qq/" onclick="layer.msg('正在通过QQ登入', {icon:16, shade: 0.1, time:0})" title="QQ登入" class="iconfont icon-qq"></a>
            </li>
            <li class="layui-nav-item layui-hide-xs">
              <a href="/app/weibo/" onclick="layer.msg('正在通过微博登入', {icon:16, shade: 0.1, time:0})" title="微博登入" class="iconfont icon-weibo"></a>
            </li>
             -->
            <!-- 登入后的状态 -->
            <li class="layui-nav-item">
                <a class="fly-nav-avatar" href="javascript:;">
                    <cite class="layui-hide-xs">贤心</cite>
                    <i class="iconfont icon-renzheng layui-hide-xs" title="认证信息：layui 作者"></i>
                    <i class="layui-badge fly-badge-vip layui-hide-xs">VIP3</i>
                    <img src="https://tva1.sinaimg.cn/crop.0.0.118.118.180/5db11ff4gw1e77d3nqrv8j203b03cweg.jpg">
                </a>
                <dl class="layui-nav-child">
                    <dd><a href="../user/set.html"><i class="layui-icon">&#xe620;</i>基本设置</a></dd>
                    <dd><a href="../user/message.html"><i class="iconfont icon-tongzhi" style="top: 4px;"></i>我的消息</a>
                    </dd>
                    <dd><a href="../user/home.html"><i class="layui-icon" style="margin-left: 2px; font-size: 22px;">&#xe68e;</i>我的主页</a>
                    </dd>
                    <hr style="margin: 5px 0;">
                    <dd><a href="" style="text-align: center;">退出</a></dd>
                </dl>
            </li>
        </ul>
    </div>
</div>

<div class="layui-hide-xs">
    <div class="fly-panel fly-column">
        <div class="layui-container">
            <ul class="layui-clear">
                <li class="layui-hide-xs"><a href="/">首页</a></li>
                <li class="layui-this"><a href="">提问</a></li>
                <li><a href="">分享<span class="layui-badge-dot"></span></a></li>
                <li><a href="">讨论</a></li>
                <li><a href="">建议</a></li>
                <li><a href="">公告</a></li>
                <li><a href="">动态</a></li>
                <li class="layui-hide-xs layui-hide-sm layui-show-md-inline-block"><span class="fly-mid"></span></li>

                <!-- 用户登入后显示 -->
                <li class="layui-hide-xs layui-hide-sm layui-show-md-inline-block"><a
                        href="../user/index.html">我发表的贴</a></li>
                <li class="layui-hide-xs layui-hide-sm layui-show-md-inline-block"><a
                        href="../user/index.html#collection">我收藏的贴</a></li>
            </ul>

            <div class="fly-column-right layui-hide-xs">
                <span class="fly-search"><i class="layui-icon"></i></span>
                <a href="add.html" class="layui-btn">发表新帖</a>
            </div>
            <div class="layui-hide-sm layui-show-xs-block"
                 style="margin-top: -10px; padding-bottom: 10px; text-align: center;">
                <a href="add.html" class="layui-btn">发表新帖</a>
            </div>
        </div>
    </div>
</div>

<div class="layui-container">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md8 content detail">
            <div class="fly-panel detail-box">
                <!-- 标题 -->
                <h1 class="title">
                    <span class="layui-badge layui-badge-green">话题</span>
                    Fly Template v3.0，基于 layui 的极简社区页面模版
                </h1>
                <div class="fly-detail-info">
                    <!-- <span class="layui-badge">审核中</span> -->
                    <!-- <span class="layui-badge layui-bg-green fly-detail-column">编辑</span> -->
                    <span class="layui-badge" style="background-color: #5FB878;">编辑</span>

                    <span class="layui-badge" style="background-color: #999;">删除</span>
                    <span class="layui-badge" style="background-color: #999;">锁定</span>
                    <!-- <span class="layui-badge" style="background-color: #5FB878;">锁定</span> -->

                    <span class="layui-badge layui-bg-blue">置顶</span>
                    <span class="layui-badge layui-bg-red">精帖</span>
                    <span class="fly-list-nums">
                      <a href="#comment"><i class="iconfont" title="回答">&#xe60c;</i> 66</a>
                      <i class="iconfont" title="人气">&#xe60b;</i> 99999
                    </span>
                </div>
                <div class="detail-about">
                    <a class="fly-avatar" href="../user/home.html">
                        <img src="https://tva1.sinaimg.cn/crop.0.0.118.118.180/5db11ff4gw1e77d3nqrv8j203b03cweg.jpg"
                             alt="贤心">
                    </a>
                    <div class="fly-detail-user">
                        <a href="../user/home.html" class="fly-link">
                            <cite>贤心</cite>
                            <i class="iconfont icon-renzheng" title="认证信息：{{ rows.user.approve }}"></i>
                            <i class="layui-badge fly-badge-vip">VIP3</i>
                        </a>
                        <span>2017-11-30</span>
                    </div>
                    <div class="detail-hits" id="LAY_jieAdmin" data-id="123">
                        <span style="padding-right: 10px; color: #FF7200">悬赏：60飞吻</span>
                        <span class="layui-badge layui-badge-blue">标签1</span>
                    </div>
                </div>
                <div class="detail-body photos">
                    内容
                </div>

                <div class="post-footer">
                    <span class="layui-icon layui-icon-praise"><i>967</i></span>
                    <span class="layui-icon layui-icon-star"><i>123</i></span>
                    <span class="layui-icon layui-icon-share"><i>分享</i></span>
                </div>
            </div>

            <div class="fly-panel detail-box" id="flyReply">
                <fieldset class="layui-elem-field layui-field-title" style="text-align: center;">
                    <legend>评论</legend>
                </fieldset>

                <ul class="jieda" id="jieda">
                    <li data-id="111" class="jieda-daan">
                        <a name="item-1111111111"></a>
                        <div class="detail-about detail-about-reply">
                            <a class="fly-avatar" href="">
                                <img src="https://tva1.sinaimg.cn/crop.0.0.118.118.180/5db11ff4gw1e77d3nqrv8j203b03cweg.jpg"
                                     alt=" ">
                            </a>
                            <div class="fly-detail-user">
                                <a href="" class="fly-link">
                                    <cite>贤心</cite>
                                    <i class="iconfont icon-renzheng" title="认证信息：XXX"></i>
                                    <i class="layui-badge fly-badge-vip">VIP3</i>
                                </a>

                                <span>(楼主)</span>
                                <!--
                                <span style="color:#5FB878">(管理员)</span>
                                <span style="color:#FF9E3F">（社区之光）</span>
                                <span style="color:#999">（该号已被封）</span>
                                -->

                            </div>

                            <div class="detail-hits">
                                <span>2017-11-30 11:05</span>
                                <div style="float: right;">
                                    <span type="edit">编辑</span>
                                    <span type="del" style="margin-left: 12px;">删除</span>
                                    <!-- <span class="jieda-accept" type="accept">采纳</span> -->
                                </div>
                            </div>
                            <!-- 采纳的图标 -->
                            <!-- <i class="iconfont icon-caina" title="最佳答案"></i> -->

                        </div>
                        <!-- 评论的内容 -->
                        <div class="detail-body jieda-body photos">
                            <p>香菇那个蓝瘦，这是一条被采纳的回帖</p>
                        </div>

                        <div class="jieda-reply">
                            <div style="float: right;">
                                <span type="edit">展开评论</span>
                                <span type="reply">
                  <i class="iconfont icon-svgmoban53"></i>
                  回复
                </span>
                                <!-- <span class="jieda-accept" type="accept">采纳</span> -->
                            </div>
                            <div style="clear: both;"></div>
                        </div>

                        <!-- 二级评论 -->
                        <div class="layui-row" style="margin: 20px 0;">
                            <div class="layui-col-xs-offset1">
                                <div class="detail-about detail-about-reply">
                                    <a class="fly-avatar" href="">
                                        <img src="https://tva1.sinaimg.cn/crop.0.0.118.118.180/5db11ff4gw1e77d3nqrv8j203b03cweg.jpg"
                                             alt=" ">
                                    </a>
                                    <div class="fly-detail-user">
                                        <a href="" class="fly-link">
                                            <cite>贤心</cite>
                                            <i class="iconfont icon-renzheng" title="认证信息：XXX"></i>
                                            <i class="layui-badge fly-badge-vip">VIP3</i>
                                        </a>
                                        <span>(楼主)</span>
                                    </div>
                                    <div class="detail-hits">
                                        <span>2017-11-30 16:34</span>&nbsp;回复
                                        <a href="" class="fly-link"><cite>王小明</cite></a>&nbsp;的
                                        <a href="" class="fly-link"><cite>评论</cite></a>
                                        <div style="float: right;">
                                            <span type="edit">编辑</span>
                                            <span type="del" style="margin-left: 12px;">删除</span>
                                            <!-- <span class="jieda-accept" type="accept">采纳</span> -->
                                        </div>
                                    </div>
                                </div>
                                <!-- 评论的内容 -->
                                <div class="detail-body jieda-body photos">
                                    <p>该模版由 layui官方社区（fly.layui.com）倾情提供，只为表明我们对 layui 执着的信念、以及对未来持续加强的承诺。该模版基于 layui
                                        搭建而成，可作为极简通用型社区的页面支撑。</p>
                                </div>
                                <div class="jieda-reply">
                                    <div style="float: right;">
                                        <span type="reply">
                                          <i class="iconfont icon-svgmoban53"></i>
                                          回复
                                        </span>
                                        <!-- <span class="jieda-accept" type="accept">采纳</span> -->
                                    </div>
                                    <div style="clear: both;"></div>
                                </div>
                            </div>
                        </div>
                    </li>


                    <!-- 无数据时 -->
                    <!-- <li class="fly-none">消灭零回复</li> -->
                </ul>

                <div class="layui-form layui-form-pane">
                    <form action="/jie/reply/" method="post">
                        <div class="layui-form-item layui-form-text">
                            <a name="comment"></a>
                            <div class="layui-input-block">
                                <textarea id="editorContent" name="content"
                                          placeholder="详细描述" class="layui-textarea fly-editor"
                                          style="height: 260px;"></textarea>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label for="L_vercode" class="layui-form-label">人类验证</label>
                                <div class="layui-input-inline">
                                    <input type="text" id="L_vercode" name="captcha" required lay-verify="required"
                                           placeholder="验证码" autocomplete="off" class="layui-input">

                                </div>
                                <div class="layui-input-inline">
                                    <img id="captchaImage" th:src="@{/captcha(token=${token})}" class="captcha" alt=""
                                         onclick="onCaptchaImageClicked(this)"/>
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <input type="hidden" name="jid" value="123">
                            <button class="layui-btn" lay-filter="*" lay-submit>提交回复</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="layui-col-md4">
            <dl class="fly-panel fly-list-one">
                <dt class="fly-panel-title">本周热议</dt>
                <dd>
                    <a href="">基于 layui 的极简社区页面模版</a>
                    <span><i class="iconfont icon-pinglun1"></i> 16</span>
                </dd>

                <!-- 无数据时 -->
                <!--
                <div class="fly-none">没有相关数据</div>
                -->
            </dl>

            <div class="fly-panel">
                <div class="fly-panel-title">
                    这里可作为广告区域
                </div>
                <div class="fly-panel-main">
                    <a href="http://layim.layui.com/?from=fly" target="_blank" class="fly-zanzhu"
                       time-limit="2017.09.25-2099.01.01" style="background-color: #5FB878;">LayIM 3.0 - layui 旗舰之作</a>
                </div>
            </div>

            <div class="fly-panel" style="padding: 20px 0; text-align: center;">
                <img src="../../res/images/weixin.jpg" style="max-width: 100%;" alt="layui">
                <p style="position: relative; color: #666;">微信扫码关注 layui 公众号</p>
            </div>

        </div>
    </div>
</div>

<div class="fly-footer">
    <p><a href="http://fly.layui.com/" target="_blank">Fly社区</a> 2017 &copy; <a href="http://www.layui.com/"
                                                                                target="_blank">layui.com 出品</a></p>
    <p>
        <a href="http://fly.layui.com/jie/3147/" target="_blank">付费计划</a>
        <a href="http://www.layui.com/template/fly/" target="_blank">获取Fly社区模版</a>
        <a href="http://fly.layui.com/jie/2461/" target="_blank">微信公众号</a>
    </p>
</div>

<script th:src="@{/front/res/layui/layui.js}" src="../res/layui/layui.js"></script>
<script th:src="@{/admin/assets/libs/tinymce/tinymce.min.js}"
        src="../../../assets/libs/tinymce/tinymce.min.js"></script>
<script th:src="@{/front/res/mods/app.js(v=318)}"></script>
<script th:inline="javascript">
    // layui.cache.page = 'jie';
    // layui.cache.user = {
    //     username: '游客'
    //     , uid: -1
    //     , avatar: '../../res/images/avatar/00.jpg'
    //     , experience: 83
    //     , sex: '男'
    // };

    // 验证码图片的点击事件
    function onCaptchaImageClicked(obj) {
        console.log(obj);
        var token = [[${token}]];
        obj.src = '/captcha?token=' + token + '&timestamp=' + (new Date().getTime());
    }

    layui.use(['app'], function () {
        var $ = layui.jquery
            , form = layui.form
            , app = layui.app;
        var editorObj; // 编辑器实例


        // 渲染富文本编辑器
        tinymce.init({
            selector: '#editorContent',
            height: 360,
            branding: false,
            language: 'zh_CN',
            plugins: 'code print preview fullscreen paste searchreplace save autosave link autolink image imagetools media table codesample lists advlist hr charmap emoticons anchor directionality pagebreak quickbars nonbreaking visualblocks visualchars wordcount',
            toolbar: 'fullscreen | undo redo | forecolor backcolor | bold italic underline strikethrough | alignleft aligncenter alignright | indent | numlist bullist | formatselect fontselect fontsizeselect | link image media emoticons charmap anchor pagebreak codesample',
            menubar: [],
            toolbar_drawer: 'sliding',
            images_upload_url: '/upload/image',
            file_picker_types: 'media',
            file_picker_callback: function (callback, value, meta) {
                layer.msg('暂不支持上传本地视频', {anim: 6});
            },
            init_instance_callback: function (editor) {
                // console.log(editor);
                editorObj = editor; // 保存编辑器实例
                // if (app.isNotNull(post)) {
                //     editor.setContent(post.content);
                // }
            },
            images_upload_handler: function (blobInfo, succFun, failFun) {
                var xhr, formData;
                var file = blobInfo.blob(); //转化为易于理解的file对象
                xhr = new XMLHttpRequest();
                xhr.withCredentials = false; // !!!是否携带cookie
                xhr.open('POST', '/upload/image');
                xhr.onload = function () {
                    var json;
                    // 处理响应的数据
                    res = JSON.parse(xhr.responseText);
                    if (xhr.status !== 200 || res.code !== 2000) {
                        failFun(res.msg);
                        return;
                    }
                    succFun(res.data.url[0]);
                };
                formData = new FormData();
                formData.append('image', file, file.name);//此处与源文档不一样
                xhr.send(formData);
            }
        });
    });
</script>

</body>
</html>
